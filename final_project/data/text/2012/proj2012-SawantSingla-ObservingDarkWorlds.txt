Anubhav	 Â Singla,	 Â Nandan	 Â Sawant	 Â 
Guide:	 Â Prof.	 Â Andrew	 Â Ng	 Â 
CS	 Â 229:	 Â Observing	 Â Dark	 Â Worlds	 Â 
	 Â 
the	 Â halo.	 Â  	 Â We	 Â denote	 Â the	 Â ellipticity	 Â  induced	 Â by	 Â 
the	 Â halo	 Â on	 Â the	 Â galaxy	 Â at	 Â distance	 Â r	 Â by	 Â f(r).	 Â 	 Â 
is	 Â  a	 Â  hypothetical	 Â 
Dark	 Â  Matter	 Â  Halo	 Â 
component	 Â  of	 Â  a	 Â  galaxy	 Â  whose	 Â  mass	 Â 
The	 Â  ellipticity	 Â  of	 Â  a	 Â  galaxy	 Â  at	 Â  point	 Â  (x,y)	 Â 
Introduction	 Â 
dominates	 Â  the	 Â  total	 Â  mass	 Â  of	 Â  the	 Â  galaxy.	 Â 
tangential	 Â  to	 Â  the	 Â halo	 Â  at	 Â  (xâ€™,yâ€™)	 Â  is	 Â  ğ‘’!"#$%#!&"â€™ =
Dark	 Â  matter	 Â  is	 Â  said	 Â  to	 Â  neither	 Â  absorb	 Â  nor	 Â 
 Â âˆ’ Â  ğ‘’! cos 2âˆ… +  Â  ğ‘’! sin 2âˆ… ,	 Â  where	 Â  âˆ…	 Â  is	 Â  the	 Â 
emit	 Â  light	 Â  and	 Â  therefore	 Â  cannot	 Â  be	 Â  directly	 Â 
angle	 Â  of	 Â  the	 Â  galaxy	 Â  with	 Â  respect	 Â  to	 Â  the	 Â  point	 Â 
observed.	 Â  However,	 Â  the	 Â  existence	 Â  of	 Â  dark	 Â 
(in	 Â our	 Â  case,	 Â  the	 Â dark	 Â matter	 Â  center)	 Â  given	 Â by	 Â 
matter	 Â  halo	 Â  can	 Â  be	 Â  inferred.	 Â  It	 Â  bends	 Â  the	 Â 
.	 Â 
âˆ… = arctan !!! !
space-Â­â€time	 Â  such	 Â  that	 Â  any	 Â  light	 Â  from	 Â  a	 Â 
!!! !
background	 Â  galaxy	 Â  will	 Â  have	 Â 
its	 Â  path	 Â 
However,	 Â the	 Â galaxies	 Â are	 Â  inherently	 Â elliptical	 Â 
altered	 Â  making	 Â  the	 Â  galaxy	 Â  appear	 Â  elliptical.	 Â 
(and	 Â  not	 Â  circular).	 Â  Moreover,	 Â  we	 Â  are	 Â 
approximating	 Â  3	 Â  dimensional	 Â  distances	 Â  and	 Â 
In	 Â  this	 Â  project,	 Â  we	 Â  investigate	 Â  the	 Â  problem	 Â 
ellipticities	 Â  in	 Â  2	 Â  dimensions.	 Â  We	 Â  model	 Â  the	 Â 
[1]	 Â of	 Â predicting	 Â the	 Â halo	 Â locations	 Â based	 Â on	 Â 
effect	 Â  of	 Â  all	 Â  these	 Â  factors	 Â  as	 Â  an	 Â  additive	 Â white	 Â 
ellipticities	 Â of	 Â galaxies	 Â in	 Â the	 Â sky.	 Â 
Gaussian	 Â noise.	 Â 	 Â 
For	 Â a	 Â galaxy	 Â at	 Â point	 Â (x,	 Â y),	 Â we	 Â can	 Â write:	 Â 
The	 Â  data[1]	 Â  consists	 Â  of	 Â  300	 Â  training	 Â  skies	 Â  and	 Â 
ğ‘’!"#$%#!&"â€™ ğ‘¥ , ğ‘¦ , ğ‘¥ ! , ğ‘¦â€² = ğ‘“ ğ‘Ÿ + ğ´ğ‘Šğºğ‘ 	 Â 
120	 Â  test	 Â  skies.	 Â  Each	 Â  sky	 Â  contains	 Â  400-Â­â€800	 Â 
Problem	 Â and	 Â Data	 Â 
galaxies.	 Â  Locations	 Â  (x	 Â  &	 Â  y	 Â  co-Â­â€ordinates)	 Â  and	 Â 
ğ‘¤â„ğ‘’ğ‘Ÿğ‘’ ,	 Â  (xâ€™,	 Â  yâ€™)	 Â  is	 Â  the	 Â  halo	 Â 
location	 Â  and	 Â 
ellipticities	 Â  (e1	 Â  &	 Â  e2)	 Â  of	 Â  the	 Â  galaxies	 Â  are	 Â 
ğ‘Ÿ =  Â  Â 
(ğ‘¥ âˆ’ ğ‘¥ ! )! + (ğ‘¦ âˆ’ ğ‘¦ ! )! 	 Â 
known.	 Â  A	 Â  sky	 Â  can	 Â  contain	 Â  1,	 Â  2	 Â  or	 Â  3	 Â  halos.	 Â  The	 Â 
number	 Â  of	 Â  halos	 Â  in	 Â  each	 Â  sky	 Â  is	 Â  told	 Â  to	 Â  us	 Â  a	 Â 
Converting	 Â back	 Â to	 Â e1	 Â and	 Â e2,	 Â 
priori.	 Â  Locations	 Â  (x	 Â  &	 Â  y	 Â  co-Â­â€ordinates)	 Â  of	 Â  the	 Â 
ğ‘’! ğ‘¥ , ğ‘¦ = ğ‘“ ğ‘Ÿ cos 2ğœ™ + ğ´ğ‘Šğºğ‘ 	 Â 	 Â 
halos	 Â in	 Â the	 Â training	 Â skies	 Â are	 Â provided	 Â to	 Â us.	 Â 
ğ‘’! ğ‘¥ , ğ‘¦ = ğ‘“(ğ‘Ÿ)sin Â (2ğœ™) + ğ´ğ‘Šğºğ‘	 Â 
Our	 Â  goal	 Â  is	 Â  to	 Â  accurately	 Â  predict	 Â  locations	 Â  of	 Â 
In	 Â case	 Â we	 Â have	 Â N	 Â halos	 Â in	 Â the	 Â sky,	 Â 	 Â 
the	 Â halos	 Â in	 Â the	 Â test	 Â skies.	 Â Evaluation	 Â metric[2]	 Â 	 Â 
is	 Â  the	 Â  average	 Â  distance	 Â  between	 Â  predicted	 Â 
and	 Â  actual	 Â  halo	 Â  locations,	 Â  with	 Â  an	 Â  additional	 Â 
!
ğ‘’! ğ‘¥ , ğ‘¦ =  Â 
ğ‘“ ğ‘Ÿ! cos Â (2ğœ™! )  Â  Â  + ğ‘(0, ğœ ! )
	 Â 
penalty	 Â term	 Â for	 Â any	 Â angular	 Â bias.	 Â 
!!!
!
	 Â 
ğ‘“ ğ‘Ÿ! sin Â (2ğœ™! )  Â  Â  + ğ‘(0, ğœ ! )
ğ‘’! ğ‘¥ , ğ‘¦ =  Â 
The	 Â  ellipticity	 Â  induced	 Â  by	 Â  the	 Â  dark	 Â  matter	 Â 
halo	 Â  on	 Â  the	 Â  galaxy	 Â  is	 Â  tangential.	 Â  We	 Â  assume	 Â 
Model	 Â 
!!!
In	 Â vector	 Â notation,	 Â 
that	 Â 
is	 Â  radially	 Â 
induced	 Â 
the	 Â  ellipticity	 Â 
symmetric	 Â and	 Â a	 Â function	 Â of	 Â the	 Â distance	 Â from	 Â 
	 Â 

1	 Â 

!
+ ğ‘(0, Î£)	 Â 
ğ’‡(ğ‘Ÿ! )
ğ’† ğ‘¥ , ğ‘¦ =  Â 
!!!
[e1	 Â 
=	 Â 
e	 Â 
e2]T	 Â 
where,	 Â 
and	 Â 
ğ’‡ ğ‘Ÿ! = [ğ‘“ ğ‘Ÿ! cos 2ğœ™!  Â 	 Â ğ‘“ ğ‘Ÿ! sin 2ğœ™! ]T.	 Â 
For	 Â  each	 Â  sky,	 Â  we	 Â  are	 Â  given	 Â  e(x,y)	 Â  for	 Â  all	 Â  the	 Â 
galaxies.	 Â  We	 Â  want	 Â  to	 Â  predict	 Â  halo	 Â  locations	 Â 
(xâ€™,yâ€™)	 Â  that	 Â  best	 Â  explain	 Â  these	 Â  observations.	 Â 
We	 Â  use	 Â  the	 Â  model	 Â  described	 Â  above	 Â  to	 Â  design	 Â 
the	 Â prediction	 Â algorithm.	 Â 
In	 Â  this	 Â  section,	 Â  we	 Â  learn	 Â  f(r),	 Â  the	 Â  induced	 Â 
ellipticity	 Â  as	 Â  a	 Â  function	 Â  of	 Â  distance	 Â  from	 Â  the	 Â 
Effect	 Â of	 Â Halo	 Â versus	 Â Distance	 Â 
halo.	 Â 	 Â 
The	 Â  function	 Â  f(r)	 Â  can	 Â  be	 Â  derived	 Â  using	 Â  the	 Â 
lensing	 Â  but	 Â  this	 Â 
theory	 Â  of	 Â  gravitational	 Â 
approach	 Â 
would	 Â 
require	 Â 
a	 Â 
deep	 Â 
understanding	 Â  of	 Â  the	 Â  subject	 Â  matter.	 Â  We	 Â 
tried	 Â  several	 Â  data	 Â  driven	 Â  approaches	 Â  â€“	 Â  linear	 Â 
regression,	 Â polynomial	 Â  fit	 Â  (of	 Â up	 Â  to	 Â 5th	 Â order)	 Â 
and	 Â 
locally	 Â  weighted	 Â 
linear	 Â  regression	 Â 
(LWLR).	 Â  LWLR	 Â  seemed	 Â  to	 Â  give	 Â  us	 Â  the	 Â  best	 Â 
results,	 Â  which	 Â  we	 Â  describe	 Â  below.	 Â  This	 Â  isnâ€™t	 Â 
surprising	 Â  given	 Â  the	 Â  enormous	 Â  amount	 Â  of	 Â 
data	 Â (60,000	 Â data	 Â points),	 Â which	 Â ensures	 Â that	 Â 
LWLR	 Â does	 Â not	 Â over-Â­â€fit	 Â and	 Â at	 Â  the	 Â same	 Â  time,	 Â 
provides	 Â  more	 Â  degrees	 Â  of	 Â  freedom	 Â  than	 Â  a	 Â 
linear	 Â regression	 Â or	 Â a	 Â small	 Â order	 Â polynomial	 Â 
fit.	 Â We	 Â  first	 Â  look	 Â  at	 Â  the	 Â  training	 Â  skies	 Â  with	 Â  only	 Â 
one	 Â  halo.	 Â  For	 Â  each	 Â  sky,	 Â  we	 Â  compute	 Â  the	 Â 
tangential	 Â  ellipticities	 Â  of	 Â  the	 Â  galaxies	 Â  with	 Â 
respect	 Â  to	 Â  the	 Â  halo	 Â  location.	 Â We	 Â  run	 Â  a	 Â  locally	 Â 
weighted	 Â  linear	 Â  regression	 Â  between	 Â  the	 Â 
computed	 Â  tangential	 Â  ellipticities	 Â  and	 Â  the	 Â 
distance	 Â between	 Â  the	 Â halo	 Â and	 Â  the	 Â galaxy.	 Â We	 Â 
see	 Â the	 Â following	 Â results:	 Â 

	 Â 

2	 Â 

	 Â 
Figure	 Â shows	 Â (the	 Â red	 Â curve)	 Â our	 Â estimate	 Â  for	 Â 
Figure	 Â  1:	 Â  LWLR	 Â  curve	 Â  modeling	 Â  induced	 Â  ellipticity	 Â  as	 Â  a	 Â  function	 Â 
f(r).	 Â  We	 Â  also	 Â  plot	 Â  the	 Â  histogram	 Â  of	 Â  deviation	 Â 
of	 Â the	 Â distance	 Â between	 Â halo	 Â and	 Â the	 Â galaxy	 Â 
from	 Â  the	 Â  LWLR	 Â  estimate.	 Â  This	 Â  reaffirms	 Â  our	 Â 
assumption	 Â that	 Â the	 Â noise	 Â is	 Â AWGN.	 Â 

	 Â 
is	 Â  not	 Â 
Further,	 Â  we	 Â  conjecture	 Â  that	 Â  f(r)	 Â 
identical	 Â  for	 Â  all	 Â  halos.	 Â  In	 Â  the	 Â  physics	 Â  context,	 Â 
Figure	 Â 2:	 Â The	 Â deviation	 Â from	 Â the	 Â LWLR	 Â fit	 Â of	 Â induced	 Â ellipticity	 Â 
we	 Â can	 Â attribute	 Â this	 Â to	 Â halos	 Â having	 Â different	 Â 
masses	 Â  and	 Â  sizes.	 Â  Based	 Â  on	 Â  our	 Â  crude	 Â  data	 Â 
analysis,	 Â we	 Â  assume	 Â  that	 Â  there	 Â  are	 Â  2	 Â  types	 Â  of	 Â 
halos	 Â  and	 Â  run	 Â  an	 Â  unsupervised	 Â  2-Â­â€means	 Â 
clustering	 Â  algorithm.	 Â  The	 Â 
labels	 Â  were	 Â 
assigned	 Â  to	 Â  the	 Â  halos	 Â  based	 Â  on	 Â  the	 Â minimum	 Â 
norm	 Â  while	 Â  the	 Â  cluster	 Â  centroids	 Â  were	 Â 
computed	 Â  using	 Â  LWLR.	 Â  Notice	 Â  that	 Â  this	 Â  is	 Â 
slightly	 Â  different	 Â  from	 Â  the	 Â  traditional	 Â  k-Â­â€
means	 Â  clustering.	 Â  Figure	 Â  below	 Â  shows	 Â  the	 Â 
two	 Â corresponding	 Â LWLR	 Â cluster	 Â centroids.	 Â 

With	 Â these	 Â feature	 Â vectors	 Â at	 Â disposal,	 Â we	 Â can	 Â 
potentially	 Â  model	 Â  the	 Â  problem	 Â  as	 Â  a	 Â  logistic	 Â 
regression	 Â  and	 Â  train	 Â  it	 Â  using	 Â  a	 Â  soft-Â­â€max	 Â  or	 Â 
SVM	 Â  classifier.	 Â  However,	 Â  given	 Â  the	 Â  variable	 Â 
number	 Â of	 Â galaxies	 Â  in	 Â each	 Â  sky,	 Â  small	 Â number	 Â 
of	 Â  training	 Â  skies	 Â  (300)	 Â  as	 Â  compared	 Â  to	 Â  the	 Â 
typical	 Â  size	 Â  of	 Â  such	 Â  feature	 Â  vector	 Â  (400-Â­â€800)	 Â 
and	 Â  a	 Â  priori	 Â  knowledge	 Â  of	 Â  number	 Â  of	 Â  halos	 Â  in	 Â 
the	 Â  sky,	 Â  we	 Â  instead	 Â  use	 Â  a	 Â  Matched	 Â  Filter[3]	 Â 
technique	 Â  known	 Â  to	 Â  be	 Â  optimal	 Â  for	 Â  signal	 Â 
processing	 Â  problems	 Â  with	 Â  Gaussian	 Â  noise	 Â 
profiles.	 Â 
Let	 Â  eij	 Â  be	 Â  the	 Â  observed	 Â  ellipticity	 Â  feature	 Â 
vector	 Â  for	 Â  the	 Â  candidate	 Â  halo	 Â  location	 Â  (ğ‘– , ğ‘—).	 Â 
According	 Â  to	 Â  Matched	 Â  Filter	 Â  technique,	 Â  we	 Â 
pick,	 Â halo	 Â 1	 Â location	 Â (xâ€™,yâ€™)	 Â as	 Â 
arg max(! ,!) ğ’‡!!" ! ğ‘’ !"
	 Â 
ğ’‡!!"
Where,	 Â  f1ij	 Â  is	 Â  the	 Â  predicted	 Â  ellipticity	 Â  feature	 Â 
vector	 Â  based	 Â  on	 Â  the	 Â  distance	 Â  based	 Â  modeling	 Â 
described	 Â  in	 Â  Figure	 Â  3.	 Â  Note	 Â  that	 Â  this	 Â  is	 Â 
nothing	 Â  but	 Â  the	 Â  weighted	 Â  average	 Â  of	 Â  the	 Â 
components	 Â of	 Â  the	 Â  feature	 Â vector	 Â  i.e.	 Â  this	 Â  is	 Â of	 Â 
the	 Â  form	 Â  ğœƒ ! ğ‘¥ .	 Â  Figure	 Â  below	 Â  shows	 Â  the	 Â 
matched	 Â  filter	 Â  output	 Â  over	 Â  the	 Â  candidate	 Â  halo	 Â 
locations.	 Â 	 Â 

	 Â 
Figure	 Â  4:	 Â Matched	 Â  filter	 Â  output	 Â  for	 Â  Halo	 Â  1	 Â  Prediction.	 Â  Red	 Â  dot	 Â  is	 Â 
the	 Â  actual	 Â  halo	 Â  1	 Â  location	 Â  while	 Â  black	 Â  dot	 Â  is	 Â  the	 Â  predicted	 Â 
location	 Â for	 Â halo	 Â 1.	 Â 

	 Â 
We	 Â  also	 Â  observe	 Â  that	 Â  a	 Â  significant	 Â  fraction	 Â  of	 Â 
halo	 Â  1s	 Â  was	 Â  mapped	 Â  to	 Â  the	 Â  (blue)	 Â  cluster	 Â 
Figure	 Â 3:	 Â LWLR	 Â cluster	 Â centroids	 Â after	 Â 2-Â­â€means	 Â clustering	 Â 
centroid	 Â  1	 Â  while	 Â  most	 Â  of	 Â  halo	 Â  2	 Â  and	 Â  3	 Â  were	 Â 
mapped	 Â  to	 Â  the	 Â  (red)	 Â  cluster	 Â  centroid	 Â  2.	 Â 
Moreover,	 Â  running	 Â  clustering	 Â  algorithm	 Â  on	 Â 
halo	 Â  2	 Â  and	 Â  3	 Â  alone	 Â  does	 Â  not	 Â  yield	 Â  such	 Â 
separation.	 Â  This	 Â  leads	 Â  us	 Â  to	 Â  the	 Â  conclusion	 Â 
that	 Â  halo	 Â  1	 Â  is	 Â much	 Â  stronger	 Â  than	 Â  halo	 Â  2	 Â  and	 Â 
3.	 Â  In	 Â  further	 Â  discussion,	 Â  we	 Â  model	 Â  halo	 Â  1	 Â  by	 Â 
f1(r)	 Â and	 Â halo	 Â 2	 Â and	 Â 3	 Â together	 Â by	 Â f23(r).	 Â 	 Â 
In	 Â  the	 Â  last	 Â  section,	 Â  we	 Â  showed	 Â  that	 Â  the	 Â  effect	 Â 
of	 Â  halo	 Â  1	 Â  is	 Â  much	 Â  stronger	 Â  than	 Â  the	 Â  effect	 Â  of	 Â 
Matched	 Â Filter	 Â Approach	 Â 
halo	 Â  2	 Â  and	 Â  3.	 Â  Therefore,	 Â  we	 Â  can	 Â  estimate	 Â 
location	 Â  of	 Â  halo	 Â  1	 Â  independent	 Â  of	 Â  halo	 Â  2	 Â  and	 Â 
halo3,	 Â  treating	 Â  interference	 Â  from	 Â halo	 Â 2	 Â and	 Â 3	 Â 
as	 Â noise.	 Â 
We	 Â discretize	 Â the	 Â problem	 Â by	 Â dividing	 Â the	 Â sky	 Â 
into	 Â a	 Â fine	 Â grid.	 Â Center	 Â of	 Â each	 Â grid	 Â square	 Â is	 Â a	 Â 
candidate	 Â  for	 Â  the	 Â  halo	 Â  1	 Â  location.	 Â  If	 Â  the	 Â  sky	 Â 
contains	 Â  G	 Â  galaxies,	 Â  each	 Â  candidate	 Â  halo	 Â 
location	 Â  can	 Â  be	 Â 
represented	 Â  by	 Â  a	 Â  G	 Â 
dimensional	 Â  feature	 Â  vector	 Â  where	 Â  gth	 Â  feature	 Â 
corresponds	 Â  to	 Â  tangential	 Â  ellipticity	 Â  at	 Â  the	 Â 
galaxy	 Â  g	 Â  with	 Â  respect	 Â  to	 Â  the	 Â  candidate	 Â  halo	 Â 
location.	 Â 	 Â 

	 Â 

3	 Â 

After	 Â  predicting	 Â  halo	 Â  1,	 Â we	 Â  subtract	 Â  the	 Â  effect	 Â 
of	 Â  halo	 Â  1	 Â  for	 Â  each	 Â  galaxy	 Â  and	 Â  re-Â­â€compute	 Â  the	 Â 
feature	 Â vectors.	 Â We	 Â use	 Â  similar	 Â matched	 Â  filter	 Â 
technique	 Â  for	 Â  halo	 Â  2	 Â  and	 Â  3	 Â  and	 Â  choose	 Â  halo	 Â 
locations	 Â (xâ€™,yâ€™)	 Â such	 Â as	 Â 
arg max(! ,!) ğ’‡!"!" ! ğ‘’ !"
	 Â 
ğ’‡!"!"
where,	 Â  	 Â  f23ij	 Â  is	 Â  the	 Â  predicted	 Â  ellipticity	 Â  feature	 Â 
vector	 Â  based	 Â  on	 Â  the	 Â  distance	 Â  based	 Â  modeling	 Â 
described	 Â  in	 Â  the	 Â  previous	 Â  section.	 Â  Figure	 Â 
below	 Â  shows	 Â  the	 Â matched	 Â  filter	 Â  output	 Â  of	 Â  the	 Â 
sky	 Â after	 Â subtracting	 Â the	 Â effect	 Â of	 Â halo	 Â 1.	 Â 	 Â 

	 Â 

Figure	 Â  5:	 Â  Matched	 Â  filter	 Â  output	 Â  after	 Â  removing	 Â  Halo	 Â  1.	 Â  Notice	 Â 
The	 Â process	 Â above	 Â is	 Â repeated	 Â for	 Â each	 Â sky.	 Â 
that	 Â  the	 Â  red	 Â  cluster	 Â  indicating	 Â  high	 Â  values	 Â  around	 Â  halo	 Â  1	 Â  has	 Â 
disappeared.	 Â  Black	 Â  dot	 Â  indicates	 Â  the	 Â  prediction	 Â  while	 Â  green	 Â  and	 Â 
blue	 Â dots	 Â indicate	 Â actual	 Â Halo	 Â 2	 Â and	 Â 3	 Â locations.	 Â 
We	 Â 
also	 Â 
implement	 Â 
some	 Â 
additional	 Â 
heuristics	 Â  to	 Â  improve	 Â  the	 Â  performance	 Â  of	 Â  our	 Â 
Additional	 Â Heuristics	 Â 
system.	 Â 
We	 Â  observe	 Â  that	 Â  the	 Â  locations	 Â  of	 Â  the	 Â  two	 Â 
halos	 Â  in	 Â  the	 Â  sky	 Â  are	 Â  sufficiently	 Â  separated.	 Â 
Zero	 Â Padding	 Â 
Therefore,	 Â  after	 Â  detecting	 Â  a	 Â  particular	 Â  halo,	 Â 
we	 Â  zero	 Â  pad	 Â  the	 Â  area	 Â  around	 Â  the	 Â  predicted	 Â 

	 Â 

4	 Â 

location	 Â  making	 Â  the	 Â  likelihood	 Â  of	 Â  finding	 Â  the	 Â 
next	 Â halo	 Â 0	 Â in	 Â the	 Â close-Â­â€by	 Â grid	 Â squares.	 Â 
Nearby	 Â  grid	 Â  squares	 Â  in	 Â  the	 Â  sky	 Â  would	 Â  have	 Â  a	 Â 
similar	 Â  likelihood	 Â  of	 Â  being	 Â  the	 Â  halo	 Â  locations.	 Â 
Low	 Â Pass	 Â Filtering	 Â 
Therefore,	 Â we	 Â pass	 Â  the	 Â output	 Â of	 Â  the	 Â matched	 Â 
filter	 Â  through	 Â  a	 Â  low	 Â  pass	 Â  filter	 Â  to	 Â  average	 Â  out	 Â 
any	 Â abrupt	 Â variations.	 Â 	 Â 
We	 Â  further	 Â  classify	 Â  the	 Â  halo	 Â  1	 Â  into	 Â  two	 Â 
categories	 Â  â€“	 Â  â€˜strongâ€™	 Â  and	 Â  â€˜weakâ€™	 Â  and	 Â  use	 Â  a	 Â 
Further	 Â classifying	 Â Halo	 Â 1	 Â 
separate	 Â  distance	 Â  dependence	 Â  of	 Â  induced	 Â 
ellipticity	 Â  for	 Â  each	 Â  class,	 Â  the	 Â  detail	 Â  that	 Â  was	 Â 
omitted	 Â in	 Â earlier	 Â sections	 Â for	 Â simplicity.	 Â 
Our	 Â  algorithm	 Â  does	 Â  an	 Â  excellent	 Â 
job	 Â  of	 Â 
predicting	 Â  halo	 Â  1	 Â  locations.	 Â  The	 Â  scatter	 Â  plot	 Â 
Results	 Â 
below	 Â  testifies	 Â 
for	 Â  the	 Â  accuracy	 Â  of	 Â  our	 Â 
predictions.	 Â 	 Â 

	 Â 
We	 Â  achieve	 Â  the	 Â  average	 Â  halo1	 Â  distance	 Â  error	 Â 
Figure	 Â 6:	 Â Predicted	 Â locations	 Â vs.	 Â actual	 Â locations	 Â for	 Â Halo	 Â 1.	 Â Note	 Â 
as	 Â  low	 Â  as	 Â  50	 Â  units.	 Â  The	 Â  evaluation	 Â metric[2]	 Â  of	 Â 
that	 Â most	 Â predictions	 Â fall	 Â around	 Â the	 Â slope	 Â 1	 Â line	 Â 
0.17	 Â can	 Â be	 Â achieved	 Â for	 Â halo	 Â 1.	 Â 
However,	 Â  the	 Â performance	 Â  for	 Â halo	 Â 2	 Â  and	 Â 3	 Â  is	 Â 
not	 Â  as	 Â  great.	 Â  Figure	 Â  below	 Â  shows	 Â  the	 Â  scatter	 Â 

plot	 Â  of	 Â  predicted	 Â  halo	 Â  locations	 Â  versus	 Â  actual	 Â 
locations	 Â for	 Â halo	 Â 2.	 Â 

is	 Â shown	 Â below.	 Â We	 Â also	 Â use	 Â this	 Â histogram	 Â to	 Â 
fine	 Â tune	 Â the	 Â parameters	 Â of	 Â our	 Â algorithm.	 Â 

	 Â 
Notice	 Â  that,	 Â  although	 Â  the	 Â  points	 Â  are	 Â  close	 Â  to	 Â 
the	 Â  slope	 Â  1	 Â  line	 Â  to	 Â  an	 Â  extent,	 Â  there	 Â  are	 Â  a	 Â  large	 Â 
Figure	 Â 7:	 Â Predicted	 Â locations	 Â vs	 Â actual	 Â locations	 Â for	 Â Halo	 Â 2.	 Â 	 Â 	 Â 
number	 Â  of	 Â  misplaced	 Â  halos	 Â  increasing	 Â  the	 Â 
average	 Â  distance	 Â  error	 Â  to	 Â  around	 Â  700-Â­â€1000	 Â 
units	 Â (for	 Â randomly	 Â chosen	 Â 120	 Â skies).	 Â 
We	 Â  have	 Â  a	 Â  theoretical	 Â  explanation	 Â  for	 Â  this	 Â 
performance.	 Â  From	 Â  Figure	 Â  2,	 Â  the	 Â  standard	 Â 
deviation	 Â  of	 Â  AWGN	 Â  noise	 Â  ğœ 	 Â  is	 Â  0.2.	 Â  The	 Â 
matched	 Â  filter	 Â  computes	 Â  the	 Â  weighted	 Â  sum	 Â 
over	 Â  all	 Â  the	 Â  galaxies,	 Â  which	 Â  brings	 Â  down	 Â  the	 Â 
noise	 Â  to	 Â  ğœ = !!  Â  ~ Â 0.0075 âˆ’ 0.01,	 Â  where	 Â  G	 Â  is	 Â 
the	 Â  number	 Â  of	 Â  galaxies.	 Â  Based	 Â  on	 Â  the	 Â  LWLR	 Â 
curve	 Â  found	 Â  in	 Â  Figure	 Â  3,	 Â  the	 Â  magnitude	 Â  of	 Â 
average	 Â  tangential	 Â  ellipticity	 Â  induced	 Â  by	 Â  Halo	 Â 
1	 Â  is	 Â  0.035.	 Â  Halo	 Â  1	 Â  is	 Â  therefore	 Â  accurately	 Â 
estimated.	 Â  On	 Â  the	 Â  other	 Â  hand,	 Â  the	 Â  average	 Â 
induced	 Â  ellipticity	 Â  for	 Â Halo	 Â  2	 Â  and	 Â  3	 Â  is	 Â  close	 Â  to	 Â 
0.01.	 Â  This	 Â  value	 Â  being	 Â  close	 Â  to	 Â  the	 Â magnitude	 Â 
of	 Â the	 Â noise	 Â leads	 Â to	 Â poor	 Â prediction.	 Â 
To	 Â  provide	 Â  a	 Â  better	 Â  measure	 Â  of	 Â  performance,	 Â 
we	 Â  randomly	 Â  chose	 Â  120	 Â  skies	 Â  out	 Â  of	 Â  the	 Â  300	 Â 
training	 Â skies	 Â provided	 Â  to	 Â us,	 Â as	 Â our	 Â  test	 Â data.	 Â 
We	 Â  compute	 Â  the	 Â  evaluation	 Â  metric	 Â  for	 Â  this	 Â 
test	 Â  set.	 Â We	 Â  repeat	 Â  this	 Â process	 Â  for	 Â 1000	 Â  such	 Â 
test	 Â  sets.	 Â  The	 Â  histogram	 Â  of	 Â  the	 Â  performance	 Â 

	 Â 

5	 Â 

	 Â 
One	 Â can	 Â notice	 Â that	 Â the	 Â performance	 Â averages	 Â 
Figure	 Â 8:	 Â Histogram	 Â of	 Â performance	 Â metric	 Â  for	 Â  randomly	 Â  chosen	 Â 
around	 Â  the	 Â  score	 Â  of	 Â  1.07	 Â  with	 Â  standard	 Â 
test	 Â sets	 Â of	 Â 120	 Â skies	 Â each	 Â 
deviation	 Â  of	 Â  0.07	 Â  and	 Â  the	 Â  best	 Â  score	 Â  of	 Â  0.78.	 Â 	 Â 
Our	 Â  score	 Â  on	 Â  Kaggleâ€™s	 Â  public	 Â  test	 Â  set	 Â  is	 Â  1.13.	 Â 
Here	 Â is	 Â a	 Â summary	 Â of	 Â the	 Â performance:	 Â 	 Â 
Randomly	 Â Placed	 Â Halos	 Â 
1.95	 Â 
Gridded	 Â Signal	 Â Benchmark	 Â 
1.58	 Â 
1.02	 Â 
Lenstool*	 Â 
Score	 Â 
Benchmark	 Â 
Our	 Â algorithm**	 Â 
1.07	 Â 
*	 Â Based	 Â on	 Â theory	 Â of	 Â gravitational	 Â lensing	 Â 
**	 Â Averaged	 Â over	 Â the	 Â training	 Â set	 Â 
Weâ€™d	 Â  like	 Â  to	 Â  thank	 Â  Prof.	 Â  Ng	 Â  and	 Â  the	 Â  entire	 Â 
CS229	 Â  teaching	 Â  staff	 Â  for	 Â  their	 Â  able	 Â  guidance.	 Â 
Acknowledgements	 Â 
Weâ€™d	 Â like	 Â to	 Â thank	 Â Kaggle.com	 Â for	 Â the	 Â dataset.	 Â 
[1]	 Â http://www.kaggle.com/c/DarkWorlds/	 Â 
References	 Â 
[2]	 Â http://www.kaggle.com/c/DarkWorlds/detai
ls/evaluation	 Â 	 Â 
[3]	 Â  Wireless	 Â  Communications	 Â  by	 Â  Andrea	 Â 
Goldsmith,	 Â Cambridge	 Â Univ.	 Â Press,	 Â 2005	 Â 

